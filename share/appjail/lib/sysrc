#
# Copyright (c) 2022, Jes√∫s Daniel Colmenares Oviedo <DtxdF@disroot.org>
# All rights reserved.
#
# This source code is licensed under the BSD-style license found in the
# LICENSE file in the root directory of this source tree.

JAIL_TYPE_TINY="tiny"
JAIL_TYPE_HUGE="huge"
JAIL_TYPE_INVALID="-"
VALID_JAIL_TYPES="${JAIL_TYPE_TINY} ${JAIL_TYPE_HUGE}"

lib_jail_gettype()
{
	local _rc _chk _t

	_rc="$1"

	if [ -z "${_rc}" ]; then
		lib_err ${EX_USAGE} "usage: lib_jail_gettype rc_conf"
	fi

	if [ ! -f "${_rc}" ]; then
		# For backward compatibility. In previous versions this file does not exists
		# and the unique way to create an appjail is huge.
		echo "${JAIL_TYPE_HUGE}"
		return 0
	fi

	_t="`sysrc -nf "${_rc}" type`"

	for _chk in ${VALID_JAIL_TYPES}; do
		if [ "${_t}" = "${_chk}" ]; then
			echo "${_t}"
			return 0
		fi
	done

	# Invalid type
	echo "${JAIL_TYPE_INVALID}"
	return 1
}
